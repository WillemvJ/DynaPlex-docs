

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="">
    
    
      
        <title>Implementing the Airplane MDP - DynaPlex  documentation</title>
      
    
    
      
        
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.18f6a3adf736b3afd.min.css?v=4071ca33" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="darkcyan" data-md-color-accent="cornflowerblue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="DynaPlex  documentation" class="md-header__button md-logo" aria-label="DynaPlex  documentation" data-md-component="logo">
      <img src="../_static/icon.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DynaPlex  documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Implementing the Airplane MDP
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="darkcyan" data-md-color-accent="cornflowerblue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="darkcyan" data-md-color-accent="cornflowerblue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/WillemvJ/DynaPlexPrivate/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    DynaPlexPrivate
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="DynaPlex  documentation" class="md-nav__button md-logo" aria-label="DynaPlex  documentation" data-md-component="logo">
      <img src="../_static/icon.png" alt="logo">
    </a>
    DynaPlex  documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/WillemvJ/DynaPlexPrivate/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    DynaPlexPrivate
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1">
          <span class="md-ellipsis">Getting started</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Getting started</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/introduction_to_mdp.html" class="md-nav__link">
        <span title="/getting_started/introduction_to_mdp.rst (reference label)" class="md-ellipsis">A brief introduction to MDPs</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/installation.html" class="md-nav__link">
        <span title="/getting_started/installation.rst (reference label)" class="md-ellipsis">Installation instructions</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/conda.html" class="md-nav__link">
        <span title="/getting_started/conda.rst (reference label)" class="md-ellipsis">Conda Environment Setup</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/adding_model.html" class="md-nav__link">
        <span title="/getting_started/adding_model.rst (reference label)" class="md-ellipsis">Adding your MDP model</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/testing.html" class="md-nav__link">
        <span title="/getting_started/testing.rst (reference label)" class="md-ellipsis">Unit testing</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2">
          <span class="md-ellipsis">Tutorial</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Tutorial</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="airplane_mdp.html" class="md-nav__link">
        <span title="/tutorial/airplane_mdp.rst (reference label)" class="md-ellipsis">Airplane MDP formulation</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="setup.html" class="md-nav__link">
        <span title="/tutorial/setup.rst (reference label)" class="md-ellipsis">Setting up</span>
      </a>
    </li>
  

            
          
            
              
  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/tutorial/adding_mdp.rst (reference label)" class="md-ellipsis">Implementing the Airplane MDP</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/tutorial/adding_mdp.rst (reference label)" class="md-ellipsis">Implementing the Airplane MDP</span>
      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#state-and-parameter-definition" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#state-and-parameter-definition (reference label)" class="md-ellipsis">State and parameter definition</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event-definition" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#event-definition (reference label)" class="md-ellipsis">Event definition</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getstate-and-tovargroup" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#getstate-and-tovargroup (reference label)" class="md-ellipsis">Get<wbr>State and To<wbr>Var<wbr>Group</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getstaticinfo" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#getstaticinfo (reference label)" class="md-ellipsis">Get<wbr>Static<wbr>Info</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mdp-initializer" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#mdp-initializer (reference label)" class="md-ellipsis">MDP initializer</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mdp-logic" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#mdp-logic (reference label)" class="md-ellipsis">MDP logic</span>
  </a>
  
    <nav class="md-nav" aria-label="MDP logic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-state" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#initial-state (reference label)" class="md-ellipsis">Initial state</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-logic" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#event-logic (reference label)" class="md-ellipsis">Event logic</span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#action-logic" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#action-logic (reference label)" class="md-ellipsis">Action logic</span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#provide-state-features" class="md-nav__link">
    <span title="/tutorial/adding_mdp.rst#provide-state-features (reference label)" class="md-ellipsis">Provide state features</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="policy.html" class="md-nav__link">
        <span title="/tutorial/policy.rst (reference label)" class="md-ellipsis"><wbr>[Optional] Custom policy</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="testing_running.html" class="md-nav__link">
        <span title="/tutorial/testing_running.rst (reference label)" class="md-ellipsis">Testing and running the MDP</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3">
          <span class="md-ellipsis">Reference</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Reference</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/model_ref.html" class="md-nav__link">
        <span title="/reference/model_ref.rst (reference label)" class="md-ellipsis">Modelling reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/policy_ref.html" class="md-nav__link">
        <span title="/reference/policy_ref.rst (reference label)" class="md-ellipsis">Custom policy reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/exact_ref.html" class="md-nav__link">
        <span title="/reference/exact_ref.rst (reference label)" class="md-ellipsis">Exact policy reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/event.html" class="md-nav__link">
        <span title="/reference/event.rst (reference label)" class="md-ellipsis">Event class reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/mdp.html" class="md-nav__link">
        <span title="/reference/mdp.rst (reference label)" class="md-ellipsis">MDP class reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/state.html" class="md-nav__link">
        <span title="/reference/state.rst (reference label)" class="md-ellipsis">State class reference</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tester.html" class="md-nav__link">
        <span title="/reference/tester.rst (reference label)" class="md-ellipsis">Tester class reference</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4">
          <span class="md-ellipsis">Algorithms</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Algorithms" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Algorithms</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithms/algorithms.html" class="md-nav__link">
        <span title="/algorithms/algorithms.rst (reference label)" class="md-ellipsis">Algorithms</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5">
          <span class="md-ellipsis">Getting help and Contributing</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting help and Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Getting help and Contributing</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../community/contributing.html" class="md-nav__link">
        <span title="/community/contributing.rst (reference label)" class="md-ellipsis">Contributing</span>
      </a>
    </li>
  

            
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../community/getting_help.html" class="md-nav__link">
        <span title="/community/getting_help.rst (reference label)" class="md-ellipsis">Getting help</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6">
          <span class="md-ellipsis">Troubleshooting</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Troubleshooting" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Troubleshooting</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/faq.html" class="md-nav__link">
        <span title="/faq/faq.rst (reference label)" class="md-ellipsis">Troubleshooting</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7">
          <span class="md-ellipsis">Legacy</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Legacy" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          <span class="md-ellipsis">Legacy</span>
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
  
    <li class="md-nav__item">
      <a href="../legacy/legacy.html" class="md-nav__link">
        <span title="/legacy/legacy.rst (reference label)" class="md-ellipsis">Changes from Legacy <wbr>(v0.<wbr>0)</span>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<h1 id="implementing-the-airplane-mdp">Implementing the Airplane MDP<a class="headerlink" href="#implementing-the-airplane-mdp" title="Permalink to this heading">¶</a></h1>
<p>We will take the following steps:</p>
<ol class="arabic simple">
<li><p>Define what a state is in <code class="docutils literal notranslate"><span class="pre">mdp.h</span></code>.</p></li>
<li><p>Define what an event is in <code class="docutils literal notranslate"><span class="pre">mdp.h</span></code>.</p></li>
<li><p>Provide the state in <code class="docutils literal notranslate"><span class="pre">GetState()</span></code> and <code class="docutils literal notranslate"><span class="pre">ToVarGroup()</span></code> functions.</p></li>
<li><p>Provide all needed static info in <code class="docutils literal notranslate"><span class="pre">GetStaticInfo()</span></code>.</p></li>
<li><p>Provide the MDP initializer in <code class="docutils literal notranslate"><span class="pre">MDP()</span></code>.</p></li>
<li><p>Provide all MDP logic.</p></li>
<li><p>Provide state feature information to the RL-policy</p></li>
</ol>
<h2 id="state-and-parameter-definition">State and parameter definition<a class="headerlink" href="#state-and-parameter-definition" title="Permalink to this heading">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">mdp.h</span></code> we can define all variables in a state. DynaPlex is flexible, in the sense that it allows all kinds of states and structure.</p>
<blockquote>
<div><p>The state consists the remaining days, remaining seats, and the price the current customer is willing to pay
Aside from the state variables, we also define MDP parameters that are static, i.e., not dependent on events or actions. This is the price that the different types of customers are willing to pay for a seat, and the arrival distribution of customere types (to be defined later).
Furthermore, we want to be able to be able to configure the initial values for the number of seats and days, later we will show how, but we already define both here.</p>
</div></blockquote>
<div class="hint admonition">
<p class="admonition-title">Hint</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">int</span></code> datatypes, we advise to use <code class="docutils literal notranslate"><span class="pre">int64_t</span></code>, since this is best compatible with pytorch.</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MDP</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span>

<span class="w">                </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">DiscreteDist</span><span class="w"> </span><span class="n">cust_dist</span><span class="p">;</span><span class="c1">//the distribution of customer types</span>
<span class="w">                </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">PricePerSeatPerCustType</span><span class="p">;</span>

<span class="w">                </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">InitialSeats</span><span class="p">;</span><span class="c1">//get from json file</span>
<span class="w">                </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">InitialDays</span><span class="p">;</span><span class="c1">//get from json file</span>

<span class="w">                </span><span class="k">struct</span><span class="w"> </span><span class="nc">State</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">RemainingDays</span><span class="p">;</span>
<span class="w">                        </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">RemainingSeats</span><span class="p">;</span>
<span class="w">                        </span><span class="kt">double</span><span class="w"> </span><span class="n">PriceOfferedPerSeat</span><span class="p">;</span>

<span class="w">                        </span><span class="c1">//using this is recommended:</span>
<span class="w">                        </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">StateCategory</span><span class="w"> </span><span class="n">cat</span><span class="p">;</span>
<span class="w">                        </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">VarGroup</span><span class="w"> </span><span class="nf">ToVarGroup</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
<span class="w">                        </span><span class="c1">//Defaulting this does not always work. It can be removed as only the exact solver would benefit from this.</span>
<span class="w">                        </span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">State</span><span class="o">&amp;</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<span class="w">                </span><span class="p">};</span>
<span class="p">...</span>
</code></pre></div>
</div>
<h2 id="event-definition">Event definition<a class="headerlink" href="#event-definition" title="Permalink to this heading">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">mdp.h</span></code>, we define what we consider a state. By default, events are <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> datatypes. Although the events for this MDP could be defined as such, we will define them as <code class="docutils literal notranslate"><span class="pre">struct</span></code> to show how this works.</p>
<blockquote>
<div><p>Add the following in <code class="docutils literal notranslate"><span class="pre">mdp.h</span></code></p>
</div></blockquote>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="c1">//Events can take on any structure, here we use structs to showcase, but we may use int64_t if events are simpler</span>
<span class="w">                </span><span class="k">struct</span><span class="w"> </span><span class="nc">Event</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="kt">double</span><span class="w"> </span><span class="n">PriceOfferedPerSeat</span><span class="p">;</span>
<span class="w">                </span><span class="p">};</span>
<span class="p">...</span>
</code></pre></div>
</div>
<h2 id="getstate-and-tovargroup">GetState and ToVarGroup<a class="headerlink" href="#getstate-and-tovargroup" title="Permalink to this heading">¶</a></h2>
<p>Next, we add some needed info to get/set the state. In <code class="docutils literal notranslate"><span class="pre">mdp.cpp</span></code>, we add the following two functions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="n">DynaPlex</span><span class="o">::</span><span class="n">VarGroup</span><span class="w"> </span><span class="nf">MDP::State::ToVarGroup</span><span class="p">()</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">        </span><span class="c1">//add all state variables</span>
<span class="w">        </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">VarGroup</span><span class="w"> </span><span class="n">vars</span><span class="p">;</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;cat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cat</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;RemainingDays&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">RemainingDays</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;RemainingSeats&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">RemainingSeats</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;PriceOfferedPerSeat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">PriceOfferedPerSeat</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">vars</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="n">MDP</span><span class="o">::</span><span class="n">State</span><span class="w"> </span><span class="nf">MDP::GetState</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">VarGroup</span><span class="o">&amp;</span><span class="w"> </span><span class="n">vars</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">State</span><span class="w"> </span><span class="n">state</span><span class="p">{};</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;cat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">cat</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;RemainingDays&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;RemainingSeats&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;PriceOfferedPerSeat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">state</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="getstaticinfo">GetStaticInfo<a class="headerlink" href="#getstaticinfo" title="Permalink to this heading">¶</a></h2>
<p>Next, we can add the relevant MDP information. In this function, various MDP design choices cna be made. For now, we keep it simple:
We add the number of valid action, and the fact that our MDP is terminating, i.e. finite</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="n">VarGroup</span><span class="w"> </span><span class="nf">MDP::GetStaticInfo</span><span class="p">()</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">VarGroup</span><span class="w"> </span><span class="n">vars</span><span class="p">;</span>
<span class="w">        </span><span class="c1">//We can either accept or reject each arriving customer:</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;valid_actions&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">        </span><span class="n">vars</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;horizon_type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;finite&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">vars</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="mdp-initializer">MDP initializer<a class="headerlink" href="#mdp-initializer" title="Permalink to this heading">¶</a></h2>
<p>Next, we need to provide a function that is called when initializing the MDP, this sets all relevant static info, as defined in <code class="docutils literal notranslate"><span class="pre">mdp.h</span></code>
We also provide the probability distribution of different customer type arrivals.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="n">MDP</span><span class="o">::</span><span class="n">MDP</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">VarGroup</span><span class="o">&amp;</span><span class="w"> </span><span class="n">config</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;InitialDays&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">InitialDays</span><span class="p">);</span><span class="c1">//get from json file</span>
<span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&quot;InitialSeats&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">InitialSeats</span><span class="p">);</span><span class="c1">//get from json file</span>

<span class="w">        </span><span class="n">PricePerSeatPerCustType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">3000.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2000.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1000.0</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="c1">//probability distribution 0 (w. prob 0.4), 1 (w. prob 0.3), 2 (w. prob 0.3).</span>
<span class="w">        </span><span class="n">cust_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DiscreteDist</span><span class="o">::</span><span class="n">GetCustomDist</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>

<span class="w">        </span><span class="c1">//Of course, any MDP property can be parameterized, but you can also</span>
<span class="w">        </span><span class="c1">//fix some things - configuration can always be expanded later.</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>Next, we can provide the values for <code class="docutils literal notranslate"><span class="pre">InitialDays</span></code> and <code class="docutils literal notranslate"><span class="pre">InitialSeats</span></code> from the <code class="docutils literal notranslate"><span class="pre">mdp_config_0.json</span></code> file</p>
<blockquote>
<div><p>Open the <code class="docutils literal notranslate"><span class="pre">mdp_config_0.json</span></code> file and change it to:</p>
</div></blockquote>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;airplane&quot;</span><span class="p">,</span>
<span class="nt">&quot;InitialDays&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="nt">&quot;InitialSeats&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="hint admonition">
<p class="admonition-title">Hint</p>
<p>Providing static info with <code class="docutils literal notranslate"><span class="pre">.json</span></code> files allows to easily test multiple configurations. It also helps in understanding the configuration parameters that an MDP accepts, as a form of documentation.</p>
</div>
<h2 id="mdp-logic">MDP logic<a class="headerlink" href="#mdp-logic" title="Permalink to this heading">¶</a></h2>
<h3 id="initial-state">Initial state<a class="headerlink" href="#initial-state" title="Permalink to this heading">¶</a></h3>
<p>We start with the function that initializes all state variables at the start of the horizon.
For this MDP, we have three state categories: pre-action (post-event), post-action, and the final state, for this MDP, we start in a post-action state.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="n">MDP</span><span class="o">::</span><span class="n">State</span><span class="w"> </span><span class="nf">MDP::GetInitialState</span><span class="p">()</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">State</span><span class="w"> </span><span class="n">state</span><span class="p">{};</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateCategory</span><span class="o">::</span><span class="n">AwaitEvent</span><span class="p">();</span><span class="c1">//or AwaitAction(), depending on logic</span>
<span class="w">        </span><span class="c1">//initiate other variables.</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitialDays</span><span class="p">;</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InitialSeats</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">state</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="event-logic">Event logic<a class="headerlink" href="#event-logic" title="Permalink to this heading">¶</a></h3>
<p>We start with the event logic. First, we define a function that generates a new event.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="n">MDP</span><span class="o">::</span><span class="n">Event</span><span class="w"> </span><span class="nf">MDP::GetEvent</span><span class="p">(</span><span class="n">RNG</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rng</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//generate an event using the custom discrete distribution (see MDP() initializer)</span>
<span class="w">        </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">custType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cust_dist</span><span class="p">.</span><span class="n">GetSample</span><span class="p">(</span><span class="n">rng</span><span class="p">);</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">pricePerSeat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PricePerSeatPerCustType</span><span class="p">.</span><span class="n">at</span><span class="p">(</span><span class="n">custType</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Event</span><span class="p">(</span><span class="n">pricePerSeat</span><span class="p">);</span><span class="c1">//return the price related to the customer type</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>Next, we can define what the event changes in the state. Note that this function can optionally return costs (negative rewards) in <code class="docutils literal notranslate"><span class="pre">double</span></code> type. In our case, we only have costs after an action.
Apart from changing the state, we check if the state we are in is the final state, i.e., if there are no remaining days or seats. In that case we change the <code class="docutils literal notranslate"><span class="pre">state.cat</span></code> to <code class="docutils literal notranslate"><span class="pre">Final()</span></code>, the MDP episode will terminate.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="kt">double</span><span class="w"> </span><span class="nf">MDP::ModifyStateWithEvent</span><span class="p">(</span><span class="n">State</span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Event</span><span class="o">&amp;</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">        </span><span class="c1">//after processing this event, we await an action.</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateCategory</span><span class="o">::</span><span class="n">AwaitAction</span><span class="p">();</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span><span class="c1">//here, we check if the MDP should terminate</span>
<span class="w">                </span><span class="n">state</span><span class="p">.</span><span class="n">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateCategory</span><span class="o">::</span><span class="n">Final</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="c1">//we only have costs after an action</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h3 id="action-logic">Action logic<a class="headerlink" href="#action-logic" title="Permalink to this heading">¶</a></h3>
<p>After modifying the state with the event, we can take an action and modify the state with it.</p>
<div class="hint admonition">
<p class="admonition-title">Hint</p>
<p>It is a good habbit to build in some checks for logic errors, we provide some examples here.</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="kt">double</span><span class="w"> </span><span class="nf">MDP::ModifyStateWithAction</span><span class="p">(</span><span class="n">MDP</span><span class="o">::</span><span class="n">State</span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="k">const</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">Error</span><span class="p">(</span><span class="s">&quot;airplane::There should not be any sales in the last day.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="n">cat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StateCategory</span><span class="o">::</span><span class="n">AwaitEvent</span><span class="p">();</span><span class="c1">//after processing this action, we await an event.</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">action</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span><span class="c1">//reject offer</span>
<span class="w">                </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="o">--</span><span class="p">;</span><span class="c1">//reduce the remaining days by 1</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span><span class="w"> </span><span class="c1">//Note that flow ends when calling return, i.e.remainder of function is not carried out if action == 0</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">action</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">//Subtract the requested seats from the remaining seats</span>
<span class="w">                        </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="o">--</span><span class="p">;</span>
<span class="w">                        </span><span class="k">if</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
<span class="w">                                </span><span class="k">throw</span><span class="w"> </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">Error</span><span class="p">(</span><span class="s">&quot;airplane:: Sold too many seats.&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="c1">//One day passes.</span>
<span class="w">                        </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="o">--</span><span class="p">;</span>
<span class="w">                        </span><span class="c1">//Note that DynaPlex is by default cost-based, so we return negative reward here:</span>
<span class="w">                        </span><span class="kt">double</span><span class="w"> </span><span class="n">returnval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">state</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="p">;</span>
<span class="w">                        </span><span class="n">state</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">returnval</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="k">throw</span><span class="w"> </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">Error</span><span class="p">(</span><span class="s">&quot;airplane:: Invalid action chosen.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<p>As with most MDPs, the action space is constrained. We can define constraints in <code class="docutils literal notranslate"><span class="pre">IsAllowedAction()</span></code>.  This function returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the action is allowed.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="nf">MDP::IsAllowedAction</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">State</span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">action</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span><span class="c1">//rejection a customer is always allowed:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//If we haven&#39;t returned, apparently action=1.</span>
<span class="w">        </span><span class="c1">//Selling a seat is allowed if there is at least one seat left:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="c1">//alternative way to evaluate</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="provide-state-features">Provide state features<a class="headerlink" href="#provide-state-features" title="Permalink to this heading">¶</a></h2>
<p>Finally, we need to provide the RL-policy information about the state, claled <code class="docutils literal notranslate"><span class="pre">features</span></code>. These features are always based on the state, as these vary per the event/action that occur.
You can engineer features, or rely on the neural network to do feature abstraction based on the literal state information. In this example, we only provide the literal state.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">MDP::GetFeatures</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">State</span><span class="o">&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">,</span><span class="w"> </span><span class="n">DynaPlex</span><span class="o">::</span><span class="n">Features</span><span class="o">&amp;</span><span class="w"> </span><span class="n">features</span><span class="p">)</span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//state features as supplied to learning algorithms:</span>
<span class="w">        </span><span class="n">features</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">RemainingDays</span><span class="p">);</span>
<span class="w">        </span><span class="n">features</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">RemainingSeats</span><span class="p">);</span>
<span class="w">        </span><span class="n">features</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">PriceOfferedPerSeat</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>






                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="setup.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Setting up" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Setting up
            </div>
          </div>
        </a>
      
      
        
        <a href="policy.html" class="md-footer__link md-footer__link--next" aria-label="Next: [Optional] Custom policy" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              [Optional] Custom policy
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2023 - 2025, DynaPlex contributors.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    7.1.2.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.path", "navigation.prune", "toc.follow", "toc.integrate", "navigation.indexes"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": [], "title": "v2.0", "version": ""}], "versionPath": null}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
  </body>
</html>